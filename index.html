<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Kalkulator Patungan</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input { margin: 5px; padding: 5px; }
    .person { margin-bottom: 10px; }
    button { padding: 8px 12px; }
  </style>
</head>
<body>
  <h2>üí∏ Kalkulator Patungan dari Struk</h2>

  <div id="people"></div>

  <button onclick="addPerson()">+ Tambah Item</button>
  <hr>

  <label>Subtotal: <input type="number" id="subtotal" value="97601"></label><br>
  <label>Tax & Biaya Lain: <input type="number" id="extraFees" value="16873"></label><br>
  <label>Total Diskon: <input type="number" id="discount" value="26400"></label><br>
  <button onclick="hitung()">üí∞ Hitung Patungan</button>

  <h3>üí≥ Hasil:</h3>
  <div id="result"></div>

  <script>
    const peopleDiv = document.getElementById("people");

    function addPerson(name = '', price = '') {
      const div = document.createElement('div');
      div.className = 'person';
      div.innerHTML = `
        <input type="text" placeholder="Nama" value="${name}">
        <input type="number" placeholder="Harga" value="${price}">
        <button onclick="this.parentElement.remove()">‚ùå</button>
      `;
      peopleDiv.appendChild(div);
    }

    // Preload dari struk
    addPerson("Kopsu Coco", 20900);
    addPerson("Black Tea Machiato", 18900);
    addPerson("Americano", 29901);
    addPerson("Aero Berrycano", 27900);

    function hitung() {
      const people = Array.from(document.querySelectorAll(".person"));
      const subtotal = parseFloat(document.getElementById("subtotal").value);
      const extraFees = parseFloat(document.getElementById("extraFees").value);
      const discount = parseFloat(document.getElementById("discount").value);
      const totalHarga = subtotal;

      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "";

      let totalProporsi = 0;
      const data = people.map(p => {
        const name = p.querySelector("input[type='text']").value;
        const price = parseFloat(p.querySelector("input[type='number']").value);
        totalProporsi += price;
        return { name, price };
      });

      data.forEach(p => {
        const proporsi = p.price / totalProporsi;
        const biaya = (p.price + proporsi * extraFees - proporsi * discount).toFixed(0);
        resultDiv.innerHTML += `<p><strong>${p.name}</strong>: Rp ${Number(biaya).toLocaleString('id-ID')}</p>`;
      });
    }
  </script>
</body>
</html>
